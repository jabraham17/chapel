mason init IDontExist || echo "expected failure"


rm -rf testingPkg && mkdir testingPkg && cd testingPkg
mason init
mason init || echo "expected failure for existing mason package"
mason init --light || echo "expected failure for existing mason package"
rm Mason.toml
mason init || echo "expected failure for existing src/ directory"
mason init --light # this should succeed since --light doesn't create a src/ directory
cd ..


rm -rf testingPkg && mkdir testingPkg
mason init testingPkg
mason init testingPkg --name foobar || echo "expected failure for existing mason package"


rm -rf testingPkg && mkdir testingPkg && cd testingPkg
mason init --no-vcs
mason init --no-vcs || echo "expected failure for existing mason package"
cd ..


rm -rf testing-pkg/foo-bar && mkdir -p testing-pkg/foo-bar
mason init testing-pkg/foo-bar || echo "expected failure for invalid package name"
mason init testing-pkg/foo-bar --name foo-bar || echo "expected failure for invalid package name"
rm -rf testing-pkg


rm -rf testingPkg && mkdir testingPkg && cd testingPkg
git init -b main
mason init || echo "expected failure for existing mason package"
rm -rf .git
echo "foo" > .gitignore
MASON_LOG_LEVEL=warn mason --no-color init | grep ".gitignore already exists"
cat .gitignore
cat Mason.toml | sed '/chplVersion/d'
