+ export PKG_CONFIG_PATH=:/Users/jade/Development/chapel-lang/chapel/test/mason/mason-system/myPackages:/Users/jade/Development/chapel-lang/chapel/test/mason/mason-system/myPackages
+ PKG_CONFIG_PATH=:/Users/jade/Development/chapel-lang/chapel/test/mason/mason-system/myPackages:/Users/jade/Development/chapel-lang/chapel/test/mason/mason-system/myPackages
+ rm -rf tempMasonLib
+ mason new tempMasonLib --lib --no-vcs
Created new library project: tempMasonLib
+ cd tempMasonLib
+ mason add dummy@10.9.8 --system
Adding system dependency dummy version 10.9.8
+ mason add myWeirdPackage@77 --system
Adding system dependency myWeirdPackage version 77
+ mason add myOtherPackage --system
Adding system dependency myOtherPackage version *
+ mason add 'forGoodMeasure@*' --system
Adding system dependency forGoodMeasure version *
+ mason add unknown --system
Adding system dependency unknown version *
+ mason add myWeirdPackage@1 --system
A dependency by that name already exists in Mason.toml
Adding system dependency myWeirdPackage version 1
+ echo 'Expected failure for already added package'
Expected failure for already added package
+ cat Mason.toml
+ sed /chplVersion/d

[brick]
license = "None"
name = "tempMasonLib"
type = "library"
version = "0.1.0"

[dependencies]

[system]
dummy = "10.9.8"
forGoodMeasure = "*"
myOtherPackage = "*"
myWeirdPackage = "77"
unknown = "*"


+ mason update
Unable to locate myWeirdPackage: 77
 Found 1
+ echo 'Expected failure for missing package'
Expected failure for missing package
+ mason rm myWeirdPackage --system
Removing system dependency myWeirdPackage
+ mason update
No pkg-config package by the name of: unknown
+ echo 'Expected failure for missing package'
Expected failure for missing package
+ mason rm unknown --system
Removing system dependency unknown
+ mason update
+ cat Mason.lock
+ sed /chplVersion/d

[root]
license = "None"
name = "tempMasonLib"
type = "library"
version = "0.1.0"

[system]

[system.dummy]
include = "/my/usr/include"
libs = "-L/my/usr/lib -ldummy"
name = "dummy"
version = "10.9.8"

[system.forGoodMeasure]
include = "/my/usr/include"
libs = "-L/my/usr/lib -Wl,-rpath,/my/usr/lib -lforGoodMeasure"
name = "forGoodMeasure"
version = "4.2"

[system.myOtherPackage]
include = ""
libs = "-sMyOtherChapelReal=3.14 -sMyOtherChapelInt=17"
name = "myOtherPackage"
version = "1"


+ mason rm dummy@10.9.8 --system
Removing system dependency dummy
+ mason rm 'myOtherPackage@*' --system
Removing system dependency myOtherPackage
+ mason rm forGoodMeasure --system
Removing system dependency forGoodMeasure
+ cat Mason.toml
+ sed /chplVersion/d

[brick]
license = "None"
name = "tempMasonLib"
type = "library"
version = "0.1.0"

[dependencies]

[system]


+ cat Mason.lock
+ sed /chplVersion/d

[root]
license = "None"
name = "tempMasonLib"
type = "library"
version = "0.1.0"

[system]

[system.dummy]
include = "/my/usr/include"
libs = "-L/my/usr/lib -ldummy"
name = "dummy"
version = "10.9.8"

[system.forGoodMeasure]
include = "/my/usr/include"
libs = "-L/my/usr/lib -Wl,-rpath,/my/usr/lib -lforGoodMeasure"
name = "forGoodMeasure"
version = "4.2"

[system.myOtherPackage]
include = ""
libs = "-sMyOtherChapelReal=3.14 -sMyOtherChapelInt=17"
name = "myOtherPackage"
version = "1"


+ mason update
+ cat Mason.lock
+ sed /chplVersion/d

[root]
license = "None"
name = "tempMasonLib"
type = "library"
version = "0.1.0"

[system]


+ mason rm unknown --system
No system dependency exists by that name
Removing system dependency unknown
+ echo 'Expected failure for unknown package'
Expected failure for unknown package
